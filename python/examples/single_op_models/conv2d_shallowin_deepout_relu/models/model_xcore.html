
<html>
<head>
<style>
body {font-family: sans-serif; background-color: #fa0;}
table {background-color: #eca;}
th {background-color: black; color: white;}
h1 {
  background-color: ffaa00;
  padding:5px;
  color: black;
}

svg {
  margin: 10px;
  border: 2px;
  border-style: solid;
  border-color: black;
  background: white;
}

div {
  border-radius: 5px;
  background-color: #fec;
  padding:5px;
  margin:5px;
}

.tooltip {color: blue;}
.tooltip .tooltipcontent  {
    visibility: hidden;
    color: black;
    background-color: yellow;
    padding: 5px;
    border-radius: 4px;
    position: absolute;
    z-index: 1;
}
.tooltip:hover .tooltipcontent {
    visibility: visible;
}

.edges line {
  stroke: #333;
}

text {
  font-weight: bold;
}

.nodes text {
  color: black;
  pointer-events: none;
  font-family: monospace;
  font-size: 12px;
}
</style>

<script src="https://d3js.org/d3.v4.min.js"></script>

</head>
<body>
<h1>TensorFlow Lite Model</h2><table>
<tr><th>filename</th><td>models/model_xcore.tflite</td></tr>
<tr><th>version</th><td>3</td></tr>
<tr><th>description</th><td>TOCO + XMOS converted.</td></tr>
</table>
<div class='subgraph'><h2>Subgraph 0</h2>
<h3>Inputs/Outputs</h3>
<table><tr>
<tr>
<th>inputs</th><th>outputs</th></tr>
<tr>
<td><span class='tooltip'><span class='tooltipcontent'>1 XC_conv2d_shallowin_deepout_relu/input INT8 [1, 5, 5, 4]<br></span>[1]</span></td>
<td><span class='tooltip'><span class='tooltipcontent'>0 Identity_int8 INT8 [1, 5, 5, 16]<br></span>[0]</span></td>
</tr>
</table>
<h3>Tensors</h3>
<table><tr>
<tr>
<th>index</th><th>name</th><th>type</th><th>shape</th><th>buffer</th><th>quantization</th></tr>
<tr>
<td>0</td><td>Identity_int8</td>
<td>INT8</td>
<td>[1, 5, 5, 16]</td>
<td>3</td>
<td>{'min': [-0.769663], 'max': [0.9339233], 'scale': [0.006680731], 'zero_point': [-13], 'details_type': 'NONE', 'quantized_dimension': 0}</td>
</tr>
<tr>
<td>1</td><td>XC_conv2d_shallowin_deepout_relu/input</td>
<td>INT8</td>
<td>[1, 5, 5, 4]</td>
<td>2</td>
<td>{'min': [0.0], 'max': [0.9989184], 'scale': [0.003917327], 'zero_point': [-128], 'details_type': 'NONE', 'quantized_dimension': 0}</td>
</tr>
<tr>
<td>2</td><td>XC_conv2d_shallowin_deepout_relu/weights</td>
<td>INT8</td>
<td>[1, 5, 16, 8, 4]</td>
<td>1</td>
<td>{'scale': [0.0008771755, 0.0008844492, 0.0008783011, 0.000880799, 0.0008786127, 0.0008793337, 0.0008790771, 0.0008721456, 0.0008795753, 0.0008706303, 0.0008654804, 0.0008784199, 0.0008844258, 0.0008555881, 0.000872259, 0.0008836325], 'zero_point': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'details_type': 'NONE', 'quantized_dimension': 0}</td>
</tr>
<tr>
<td>3</td><td>XC_conv2d_shallowin_deepout_relu/biases</td>
<td>INT16</td>
<td>[2, 16]</td>
<td>0</td>
<td>{'scale': [3.461477e-06, 3.416924e-06, 3.351618e-06, 3.464585e-06, 3.441058e-06, 3.39037e-06, 3.410544e-06, 3.445584e-06, 3.41648e-06, 3.443633e-06, 3.444638e-06, 3.441813e-06, 3.450378e-06, 3.440593e-06, 3.464677e-06, 3.436184e-06], 'zero_point': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'details_type': 'CustomQuantization', 'quantized_dimension': 0}</td>
</tr>
<tr>
<td>4</td><td>XC_conv2d_shallowin_deepout_relu/shift_scale</td>
<td>INT16</td>
<td>[2, 16]</td>
<td>5</td>
<td>None</td>
</tr>
<tr>
<td>5</td><td>XC_conv2d_shallowin_deepout_relu/unpadded_shape</td>
<td>INT32</td>
<td>[4]</td>
<td>6</td>
<td>None</td>
</tr>
</table>
<h3>Ops</h3>
<table><tr>
<tr>
<th>index</th><th>inputs</th><th>outputs</th><th>opcode_index</th><th>builtin_options</th><th>custom_options</th></tr>
<tr>
<td>0</td><td><span class='tooltip'><span class='tooltipcontent'>1 XC_conv2d_shallowin_deepout_relu/input INT8 [1, 5, 5, 4]<br>2 XC_conv2d_shallowin_deepout_relu/weights INT8 [1, 5, 16, 8, 4]<br>3 XC_conv2d_shallowin_deepout_relu/biases INT16 [2, 16]<br>4 XC_conv2d_shallowin_deepout_relu/shift_scale INT16 [2, 16]<br>5 XC_conv2d_shallowin_deepout_relu/unpadded_shape INT32 [4]<br></span>[1, 2, 3, 4, 5]</span></td>
<td><span class='tooltip'><span class='tooltipcontent'>0 Identity_int8 INT8 [1, 5, 5, 16]<br></span>[0]</span></td>
<td>XC_conv2d_shallowin_deepout_relu (0)</td>
<td>None</td>
<td>None</td>
</tr>
</table>
<svg id='subgraph0' width='1600' height='900'></svg>

  <script>
    // Build graph data
    var graph = {"nodes": [{"id": "o0", "name": "XC_conv2d_shallowin_deepout_relu (0)", "text_color": "#eeeeee", "fill_color": "#00a000", "edge_radius": 10, "x": 200, "y": 200, "node_width": 275}, {"id": "t0", "name": "(0) 'Identity_int8' [1, 5, 5, 16]", "text_color": "#000000", "fill_color": "#ffcccc", "edge_radius": 1, "x": 170, "y": 300.0, "node_width": 252}, {"id": "t1", "name": "(1) 'XC_conv2d_shallowin_deepout_relu/input' [1, 5, 5, 4]", "text_color": "#000000", "fill_color": "#ccccff", "edge_radius": 1, "x": 170, "y": 100.0, "node_width": 432}, {"id": "t2", "name": "(2) 'XC_conv2d_shallowin_deepout_relu/weights' [1, 5, 16, 8, 4]", "text_color": "#000000", "fill_color": "#fffacd", "edge_radius": 1, "x": 612, "y": 100.0, "node_width": 477}, {"id": "t3", "name": "(3) 'XC_conv2d_shallowin_deepout_relu/biases' [2, 16]", "text_color": "#000000", "fill_color": "#fffacd", "edge_radius": 1, "x": 1099, "y": 100.0, "node_width": 402}, {"id": "t4", "name": "(4) 'XC_conv2d_shallowin_deepout_relu/shift_scale' [2, 16]", "text_color": "#000000", "fill_color": "#fffacd", "edge_radius": 1, "x": 1511, "y": 100.0, "node_width": 440}, {"id": "t5", "name": "(5) 'XC_conv2d_shallowin_deepout_relu/unpadded_shape' [4]", "text_color": "#000000", "fill_color": "#fffacd", "edge_radius": 1, "x": 1961, "y": 100.0, "node_width": 432}], "edges": [{"source": "t1", "target": "o0"}, {"source": "t2", "target": "o0"}, {"source": "t3", "target": "o0"}, {"source": "t4", "target": "o0"}, {"source": "t5", "target": "o0"}, {"target": "t0", "source": "o0"}]};

    var svg = d3.select("#subgraph0")
    var width = svg.attr("width");
    var height = svg.attr("height");
    // Make the graph scrollable.
    svg = svg.call(d3.zoom().on("zoom", function() {
      svg.attr("transform", d3.event.transform);
    })).append("g");


    var color = d3.scaleOrdinal(d3.schemeDark2);

    var simulation = d3.forceSimulation()
        .force("link", d3.forceLink().id(function(d) {return d.id;}))
        .force("charge", d3.forceManyBody())
        .force("center", d3.forceCenter(0.5 * width, 0.5 * height));


    function buildGraph() {
      var edge = svg.append("g").attr("class", "edges").selectAll("line")
        .data(graph.edges).enter().append("path").attr("stroke","black").attr("fill","none")

      // Make the node group
      var node = svg.selectAll(".nodes")
        .data(graph.nodes)
        .enter().append("g")
        .attr("x", function(d){return d.x})
        .attr("y", function(d){return d.y})
        .attr("node_width", function(d){return d.node_width})
        .attr("transform", function(d) {
          return "translate( " + d.x + ", " + d.y + ")"
        })
        .attr("class", "nodes")
          .call(d3.drag()
              .on("start", function(d) {
                if(!d3.event.active) simulation.alphaTarget(1.0).restart();
                d.fx = d.x;d.fy = d.y;
              })
              .on("drag", function(d) {
                d.fx = d3.event.x; d.fy = d3.event.y;
              })
              .on("end", function(d) {
                if (!d3.event.active) simulation.alphaTarget(0);
                d.fx = d.fy = null;
              }));
      // Within the group, draw a box for the node position and text
      // on the side.

      var node_width = 150;
      var node_height = 30;

      node.append("rect")
          .attr("r", "5px")
          .attr("width", function(d) { return d.node_width; })
          .attr("height", node_height)
          .attr("rx", function(d) { return d.edge_radius; })
          .attr("stroke", "#000000")
          .attr("fill", function(d) { return d.fill_color; })
      node.append("text")
          .text(function(d) { return d.name; })
          .attr("x", 5)
          .attr("y", 20)
          .attr("fill", function(d) { return d.text_color; })
      // Setup force parameters and update position callback


      var node = svg.selectAll(".nodes")
        .data(graph.nodes);

      // Bind the links
      var name_to_g = {}
      node.each(function(data, index, nodes) {
        console.log(data.id)
        name_to_g[data.id] = this;
      });

      function proc(w, t) {
        return parseInt(w.getAttribute(t));
      }
      edge.attr("d", function(d) {
        function lerp(t, a, b) {
          return (1.0-t) * a + t * b;
        }
        var x1 = proc(name_to_g[d.source],"x") + proc(name_to_g[d.source],"node_width") / 2;
        var y1 = proc(name_to_g[d.source],"y") + node_height;
        var x2 = proc(name_to_g[d.target],"x") + proc(name_to_g[d.target],"node_width") / 2;
        var y2 = proc(name_to_g[d.target],"y");
        var s = "M " + x1 + " " + y1
            + " C " + x1 + " " + lerp(.5, y1, y2)
            + " " + x2 + " " + lerp(.5, y1, y2)
            + " " + x2  + " " + y2
      return s;
    });

  }
  buildGraph()
</script>
</div><h2>Buffers</h2>
<table><tr>
<tr>
<th>index</th><th>data</th></tr>
<tr>
<td>0</td><td>64 bytes</td>
</tr>
<tr>
<td>1</td><td>2560 bytes</td>
</tr>
<tr>
<td>2</td><td>--</td>
</tr>
<tr>
<td>3</td><td>--</td>
</tr>
<tr>
<td>4</td><td>5 bytes</td>
</tr>
<tr>
<td>5</td><td>64 bytes</td>
</tr>
<tr>
<td>6</td><td>16 bytes</td>
</tr>
</table>
<h2>Operator Codes</h2>
<table><tr>
<tr>
<th>index</th><th>builtin_code</th><th>custom_code</th><th>version</th></tr>
<tr>
<td>0</td><td>CUSTOM</td>
<td>XC_conv2d_shallowin_deepout_relu</td>
<td>1</td>
</tr>
</table>
</body></html>
